<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Google Maps Game</title>
    <style>
        #map {
            height: 400px;
            width: 100%;
            background-color: grey;
        }
        #btnStart {
            height: 40px;
            width: 150px;
            text-effect: emboss;
            font-weight: bold;
            font-size: larger;
        }
    </style>
</head>
<body>
    <h3>My Google Maps Demo</h3>
    <div id="map"></div>
    <script>

        var arrMarkers = [[
                            [38.246735, -85.767436, "Louisville"],
                            [46.808521, -100.779420, "Bismarck"],
                            [36.170140, -115.179149, "Las Vegas"]
                        ],

                        [
                            [32.778796, -96.801408, "Dallas"],
                            [41.878398, -87.644291, "Chicago"],
                            [47.605504, -122.329045, "Seattle"]
                        ],

                        [
                            [25.765562, -80.197366, "Miami"],
                            [42.335115, -83.051166, "Detroit"],
                            [39.740774, -104.977362, "Denver"]
                        ]
                    ];

        var arrQuestions = [
                ["Which of these markers indicates Louisville?", "Louisville"],
                ["Which of these markers indicates Dallas?", "Dallas"],
                ["Which of these markers indicates Miami?", "Miami"] ];

        var questionNum = 0;
        var player_score = 0;
        var allMarkers = [];

        function initMap() {
            var usa = {lat: 39.930312, lng: -98.390926};
            var map = new google.maps.Map(document.getElementById('map'), {
                zoom: 4,
                center: usa,
                mapTypeId: 'satellite',
                disableDefaultUI: true
            });

            for (var x = 0; x < arrMarkers.length; x++) {
                for (var i = 0; i < arrMarkers[x].length; i++) {
                    var marker = new google.maps.Marker({
                        position: {lat: arrMarkers[x][i][0], lng: arrMarkers[x][i][1]},
                        map: map,
                        visible: false,
                        customInfo: arrMarkers[x][i][2]
                    });
                    marker.addListener('click', checkAnswer);
                    allMarkers.push(marker);
                }
            }
        }

    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyADpIV1QKhmFLqGm_Bvver2BKbDM1EIpmg&callback=initMap"></script>

    <div id="starter">
        <br>
        <p id="intro">Wanna play a game???</p>
        <center><button type="button" id="btnStart">Click to Start!</button></center>
    </div>

    <div id="questions"></div>

    <center><div id="response"></div></center>

    <script>
        var questionPara = document.getElementById("questions");
        var answerPara = document.getElementById("response");
        var mybutton = document.getElementById("btnStart");
        mybutton.addEventListener('click', startGame);
        var introPara = document.getElementById("intro");

        function startGame() {
            mybutton.style.visibility = 'hidden';
            introPara.innerHTML = "Question #" + (questionNum + 1);
            questionPara.innerHTML = arrQuestions[questionNum][0];
            answerPara.innerHTML = "";
            doubleLooping(1);
        }

        function checkAnswer() {
            if (this.customInfo == arrMarkers[questionNum][0][2]) {
                showResponse(1);
                player_score++;
            }
            else {
                showResponse(2);
            }
            doubleLooping(2);
            setTimeout(function() {
                questionNum++;
                if(questionNum < arrQuestions.length) {
                    mybutton.style.visibility = 'visible';
                }
                else {
                    introPara.innerHTML = "";
                    questionPara.innerHTML = "";
                    answerPara.style.color = "blue";
                    answerPara.innerHTML = "Your score is " + player_score + "!";
                }
            },2000);
        }

        function showResponse(option) {
            if (option == 1) {
                answerPara.innerHTML = "Correct!";
                answerPara.style.color = "green";
            }
            else {
                answerPara.innerHTML = "Wrong!";
                answerPara.style.color = "red";
            }
        }

        function doubleLooping(option) {
            for (var y = 0; y < allMarkers.length; y++) {
                for (var x = 0; x < arrMarkers[questionNum].length; x++) {
                    if (allMarkers[y].customInfo == arrMarkers[questionNum][x][2]) {
                        if (option == 1) {
                            allMarkers[y].setVisible(true);
                        }
                        else if (option == 2) {
                            allMarkers[y].setVisible(false);
                        }
                    }
                }
            }
        }
    </script>
</body>
</html>

<!--Helping sites:-->
<!--http://stackoverflow.com/questions/6611634/google-maps-api-v3-add-event-listener-to-all-markers-->
<!--http://stackoverflow.com/questions/8685107/hiding-a-button-in-javascript-->
<!--http://stackoverflow.com/questions/5030127/marker-visibility-in-google-maps-->
<!--http://stackoverflow.com/questions/4738595/how-do-i-delay-a-function-call-for-5-seconds-->